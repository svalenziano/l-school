<!DOCTYPE html>
<html>
  <head>
    <style>
      div {
        padding: 10px;
        margin: 10px;
        border: 1px solid black;
        min-width: 10px;
        min-height: 10px;
      }
      p {
        display: inline;
        font: 12px "Courier", monospace;
      }
      p:hover,
      div:hover {
        background: rgba(0, 0, 0, 0.16);
      }
    </style>

    <script>
      // SELECT THE MODE YOU WISH TO USE (Todo: add this to the UI)
      const TEST_MODE = 4;

      const testModes = {
        1: "Bubble: Attach listener to outer-most div",
        2: "Bubble: Attach listener to every div",
        3: "Capture: Attach listener to outer-most div",
        4: "Capture: Attach listener to every div",
      }

      function printTargets(e, node) {
        node.textContent += `target = ${e.target.id}, currentTarget = ${e.currentTarget.id}\n`
      }

      const DIV_IDS = ['d1', 'd2a', 'd2b', 'd3'];
      document.addEventListener("DOMContentLoaded", () => {
        // Setup the text labels
        for (let id of DIV_IDS) {
          let div = document.getElementById(id)
          let p = document.createElement('P');
          p.textContent = id;
          div.insertAdjacentElement("afterbegin", p);
        }
        let output = document.getElementById("results");
        output.textContent = `TEST MODE: "${testModes[TEST_MODE]}"\n`;

        let outermost = document.getElementById(DIV_IDS[0]);
        // Define test modes
        if (TEST_MODE === 1) {
          outermost.addEventListener('click', (e) => {
            printTargets(e, output);
          })
        } else if (TEST_MODE === 2) {
          DIV_IDS.forEach((id) => {
            document.getElementById(id).addEventListener('click', (e) => {
              printTargets(e, output);
            })
          })
        } else if (TEST_MODE === 3) {
          outermost.addEventListener(
            'click', 
            (e) => printTargets(e, output), 
            true);  // note the `true` argument!
        } else if (TEST_MODE === 4) {
          DIV_IDS.forEach((id) => {
            document.getElementById(id).addEventListener(
              'click', 
              (e) => printTargets(e, output), 
              true);
          })
        }
      });
    </script>
  </head>

  <body>
    <p>Hint: refresh to clear output (F5).  What happens when you click in each box, or directly on a text element?</p>
    <div id="d1">
      <div id="d2a">
        <div id="d3"></div>
      </div>
      <div id="d2b"></div>
    </div>
    <pre id="results"></pre>
  </body>

</html>